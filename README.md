# MyEle - 仿饿了么外卖APP

基于 Android Jetpack Compose 开发的仿饿了么外卖应用，用于 AI 操作和测试。

## 特点

- 无需登录和联网，所有数据存储在本地
- 严格遵循 MVP 架构模式
- 使用 Material Design 3 设计规范
- 完整的外卖应用功能实现

## 技术栈

- Kotlin + Jetpack Compose
- MVP 架构模式
- Navigation Compose
- Gson 数据解析
- 最低 SDK: API 33 (Android 13)

## 项目结构

```
app/src/main/
├── java/com/example/myele/
│   ├── data/              # 数据层 (Repository, CartManager)
│   ├── model/             # 数据模型
│   ├── navigation/        # 导航配置
│   ├── ui/                # UI层 (各页面 MVP 实现)
│   ├── utils/             # 工具类
│   └── MainActivity.kt
└── assets/data/           # JSON 数据文件
```

## 功能模块

- 首页：商家列表、搜索、分类导航
- 搜索：搜索推荐、历史记录、搜索结果
- 商家详情：菜品展示、购物车、收藏
- 购物车：多商家购物车管理、结算
- 订单：订单列表、订单详情、评价
- 个人中心：我的订单、地址管理、账单、设置等

## 数据说明

所有数据存储在 `app/src/main/assets/data/` 目录，采用 JSON 格式。数据围绕武汉洪山区华中师范大学周边设置，包含 **20个商家、300个商品**、地址、订单、优惠券等完整数据。

### 商家列表 (20家)
- 川香麻辣烫、老北京炸酱面、湘味轩、粤式早茶、韩式炸鸡
- 瑞幸咖啡、茶百道、蜜雪冰城、星巴克、喜茶
- **CoCo都可、麦当劳、肯德基、必胜客、海底捞火锅**
- **西贝莜面村、外婆家、黄焖鸡米饭、沙县小吃、兰州拉面**

### 商品数据
- 每个商家拥有15个特色菜品
- 总计300个商品，涵盖各类美食
- 商品包含名称、价格、规格、评分、月销量等完整信息

## 构建

1. 使用 Android Studio 打开项目
2. 等待 Gradle 同步完成
3. 运行 `./gradlew assembleDebug` 或直接点击 Run 按钮

## 图片资源

所有图片资源已配置在 `ImageUtils.kt` 中，包括：
- 商家 Logo (20个商家)
- 商品图片 (300个商品)
  - 原有40个商品：使用各自的特定图片
  - 新增260个商品：统一使用 `tongyong.png` 通用图片
- 用户头像、骑手头像等

图片文件位于 `app/src/main/res/drawable/` 目录，通过 productId 或商家名称自动匹配。

## 开发说明

项目采用严格的 MVP 架构模式，遵循以下开发规范：
- 每个页面包含 Contract、Presenter、View 三层
- 数据通过 DataRepository 统一管理
- 图片资源通过 ImageUtils 工具类加载
- 导航使用 Navigation Compose

---

**构建状态**: ✅ BUILD SUCCESSFUL

---

## 最新更新 (2025-10-31)

### 主页标签优化
1. **主页标签调整**
   - 标签顺序："常点"在左侧、"推荐"在右侧（删除了"常用"页面）
   - **默认显示"推荐"页面**，显示原主页内容（服务图标、商家列表等）
   - "常点"页面显示已收藏的商家（isFavorite），带红色爱心图标
   - 两个页面均支持下拉刷新和点击跳转商家详情
   - 保持标签顺序不变但默认打开推荐页面

### Bug修复
2. **搜索过程页面商家跳转修复**
   - 修正"专属好店"列表中商家ID，使其与实际商家数据对应
   - "北京烤鸭 (华师校园店)" ID: rest_021
   - "美滋滋烤肉拌饭" ID: rest_022
   - "肯德基" ID: rest_013
   - 现在点击商家可以正确跳转到对应的商家详情页

### 数据持久化系统
1. **PreferencesManager实现**
   - 创建SharedPreferences管理器，统一管理应用持久化数据
   - 支持支付设置、通知设置、用户信息等数据的持久化存储
   - 地址增删改功能完整实现，支持新增、编辑、删除地址

### 地址管理功能增强
2. **地址保存成功提示**
   - 新增/修改地址保存后显示成功弹窗
   - 删除地址时正确调用repository删除方法
   - 地址数据持久化存储，重启应用后保持修改

### 支付设置持久化
3. **免密支付开关**
   - 支付宝免密支付和余额免密支付开关状态持久化
   - 开关切换时显示"已开启/已关闭"弹窗提示
   - 重启应用后保持上次设置状态

### 手机号修改功能
4. **完整的手机号修改流程**
   - 点击"立即修改"弹出输入框
   - 支持输入新手机号并验证
   - 修改成功后显示成功弹窗
   - 手机号数据持久化存储

### 消息通知设置完善
5. **系统消息通知管理**
   - 点击"系统消息通知"弹出确认弹窗（"关闭"/"保留重要通知"）
   - 点击"关闭"进入通知详情页，可切换"允许通知"开关
   - 开关状态持久化，重启应用保持设置

6. **横幅通知开关**
   - 饿了么内横幅通知开关状态持久化
   - 切换时显示"已打开/已关闭"提示弹窗

7. **通知栏目跳转**
   - 聊天消息、消息号、短信通知、订单交易、权益通知、服务通知、活动优惠等栏目支持点击
   - 点击后进入对应页面，显示栏目名称
   - 订阅消息管理、清空消息列表功能入口

---

## 历史更新 (2025-10-30)

### UI优化
1. **主页界面简化**
   - 移除"爆火好店 必得25元"横幅，简化页面布局
   - 移除底部导航栏的18.8价格图标，优化导航栏布局

2. **服务图标区域优化**
   - 增加美食外卖服务图标区域高度（160dp → 220dp）
   - 确保"甜品饮品"、"学生福利"等下方一排图标完整显示，无需下拉滚动

### 交互优化
6. **外卖页面筛选栏统一**
   - 将外卖页面的排序弹窗从底部弹出改为从顶部下拉
   - 价格筛选改为双向滑动条（RangeSlider），支持0-120+价格范围调节
   - 移除了自定义价格输入框和固定价格区间选项
   - 统一与搜索结果页面的交互样式，提升用户体验一致性

### 搜索功能增强
3. **搜索发现改进**
   - 搜索发现标签改为显示已有店铺名称
   - 店铺标签可点击直接搜索，快速查找商家
   - 历史搜索标签从"备注"更新为实际店铺名称

4. **专属好店交互**
   - 专属好店列表支持点击进入商家详情页
   - 优化用户浏览体验，快速访问推荐商家

### 功能页面扩展
5. **服务入口页面**
   - 为9个服务入口（超市便利、学生福利、水果买菜、看病买药、甜品饮品、天天爆红包、爆品团、赚吃货豆、0元领水果）添加跳转页面
   - 创建通用服务页面模板 `ServicePageScreen`
   - 新增路由 `Screen.ServicePage`，支持动态显示服务名称
   - 所有服务入口点击后进入对应页面，显示"该功能正在开发中..."提示

---

## 历史更新 (2025-10-29)

### Bug修复
1. **免配送费红包券显示修复**
   - 修复订单详情页中使用免配送费红包券时显示-0元的问题
   - 更新 `Coupon.calculateDiscount()` 方法，添加 `deliveryFee` 参数
   - 免配送费券现在正确显示实际的配送费金额作为优惠

### 数据扩充
2. **商家数据大幅扩充**
   - 新增10个知名商家：CoCo都可、麦当劳、肯德基、必胜客、海底捞火锅、西贝莜面村、外婆家、黄焖鸡米饭、沙县小吃、兰州拉面
   - 商家总数从10家增加到20家

3. **商品数据完善**
   - 为所有商家生成完整的15个特色菜品
   - 商品总数从40个增加到300个（20家 × 15个）
   - 新增商品统一使用 `tongyong.png` 通用图片
   - 商品类型涵盖：川菜、粤菜、湘菜、北京菜、韩餐、西餐、快餐、奶茶、咖啡、火锅、面食等各类美食

---

## 历史更新 (2025-10-28)

### 已完成功能
1. **优惠券系统** - 结算页面集成优惠券选择
   - 结算页面添加优惠券选择功能
   - 优惠券按优惠金额从高到低排序
   - 自动筛选可用优惠券（根据订单金额和适用商家）
   - 自动计算优惠后的订单总价
   - 优惠券选择弹窗UI实现

2. **已评价页面优化**
   - 移除"修改"按钮
   - 添加删除评价确认弹窗
   - 弹窗提供"删除"和"设为匿名"两个选项
   - 优化用户体验

3. **搜索历史清除确认**
   - 历史搜索清除按钮添加确认弹窗
   - 防止误操作删除历史记录

4. **订单详情页优化**
   - 减少顶部空白区域（padding 从 24dp 优化到 16dp）
   - 确保返回按钮正常工作
   - 添加详细的食无忧理赔栏（包含三个理赔选项）
   - 实现联系商家功能（底部弹窗，与联系骑手类似）
   - 待接单状态添加取消订单功能（底部弹窗，提供5个取消原因）

5. **首页交互优化**
   - 实现下拉刷新功能（手动刷新按钮）
   - 学生特价右侧三条杠添加筛选功能（筛选弹窗）

6. **筛选功能优化**
   - 价格筛选改为双向滑动条（0-120+）
   - 支持动态调整价格区间
   - 实时显示选中的价格范围

7. **地址管理完整功能**
   - 新增地址：地图显示、地址输入、门牌号、收货人、性别选择、手机号、标签选择
   - 修改地址：编辑现有地址信息，右上角删除按钮
   - 删除地址：长按地址卡片弹出删除确认弹窗
   - 地址标签：支持"家"、"公司"、"学校"三种标签
